---
title: "RNA-seq analysis"

bibliography: references.bib
---

This report summarizes the RNA-seq analysis performed using the [rnaseq_workflow](https://github.com/vari-bbc/rnaseq_workflow) developed by the Bioinformatics and Biostatistics Core at Van Andel Institute.

The following sections describe the experimental design, summarize the differential expression results and analytical methods, and provide a list of software versions and references used in the analysis.

For detailed results, please explore the individual tabs in the interactive report.

<br>

```{r load_lib, include=F, echo=F}
library(configr)
library(tidyverse)
library(kableExtra)
library(SummarizedExperiment)
```

## Experimental design

We will list sample information for the experimental design below:

```{r print_meta, include=T, echo=F, message=F, warning=F}
se <- readRDS("../../results/SummarizedExperiment/SummarizedExperiment.rds")
meta <- colData(se) |>
        as.data.frame() |>
        tibble::rownames_to_column("sample_name") |>
        dplyr::select(-RG)

meta |>
    kbl(caption = "Sample information", row.names = FALSE) |>
    kable_classic_2(full_width = F)
```

<br>

## DE gene summary

```{r deseq_sum,  include=T, echo=F, message=F, warning=F}
config_file <- read.config("../../config/config.yaml")
fdr <- config_file$fdr_cutoff
comparisons <- list.files("../../results/deseq2/deseq2_out_files/")
comparisons <- setNames(comparisons, nm = comparisons)

de_sum_all <- do.call(rbind, (lapply(comparisons, function(comparison) {
  de_res <- read_tsv(paste0("../../results/deseq2/deseq2_out_files/", comparison, "/de_res.tsv"))
  df_sum <- data.frame( Contrast = comparison,
              Num_up_genes = de_res |> filter(padj < fdr & log2FoldChange > 0) |> nrow(),
              Num_down_genes = de_res |> filter(padj < fdr & log2FoldChange < 0) |> nrow())
  return(df_sum)
}) ) )

de_sum_all |>
  kbl(caption = paste0("DE gene summary (FDR cutoff = ", fdr, ")"), row.names = FALSE) |>
   kable_classic_2(full_width = F)

```

<br>


## Software versions and references

---
nocite: '@*'
...
