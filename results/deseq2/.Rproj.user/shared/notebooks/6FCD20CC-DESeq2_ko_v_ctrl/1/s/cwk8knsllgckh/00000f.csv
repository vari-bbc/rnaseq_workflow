"0",""
"0","set.seed(42)"
"0",""
"0","GSEA_funk = function(res, database, pval_cutoff = 0.1, minGSSize = 1, maxGSSize = 1000 ){"
"0","  "
"0","  alt_rownames = gsub(""\\.[0-9]*$"", """", rownames(res))"
"0","  alt_res = res"
"0","  rownames(alt_res) = alt_rownames"
"0","  "
"0","  # We've already built the entrez column, so this step isn't required"
"0","  # res$entrez = unname(unlist(AnnotationDbi::mapIds(database, keys=rownames(alt_res), column=""ENTREZID"", keytype=""ENSEMBL"", multiVals=""first"")))"
"0",""
"0","  res = res[!is.na(res$entrez),]"
"0","  res = res[order(res$log2FoldChange, decreasing = TRUE),]"
"0","  res_list = res$log2FoldChange"
"0","  names(res_list) = res$entrez"
"0","  "
"0","  # print(res_list)"
"0",""
"0","  res_GSEA = as.data.frame(gseGO(geneList = res_list,"
"0","                   OrgDb = database,"
"0","                   minGSSize = minGSSize,"
"0","                   maxGSSize = maxGSSize,"
"0","                   pvalueCutoff = pval_cutoff))"
"0",""
"0","  res_GSEA$genes = unname(unlist(lapply( res_GSEA$core_enrichment, FUN = function(x){"
"0","  			if (x != """"){"
"0","  				# print(x)"
"0","  				entrez_ids = as.vector(unname(unlist(strsplit(x, ""/""))))"
"0","  				alias_names = unname(unlist("
"0","  					AnnotationDbi::mapIds("
"0","  							database, "
"0","  							keys=entrez_ids, "
"0","  							column=""SYMBOL"", "
"0","  							keytype=""ENTREZID"", "
"0","  							multiVals=""first"")))"
"0","  				z = paste0(alias_names, collapse = ""/"")"
"0","  			} else {"
"0","  				z = NA"
"0","  			}"
"0","  			return(z)"
"0","  })))"
"0","  "
"0","  # print(res_GSEA)"
"0","  		"
"0","  return(res_GSEA)"
"0",""
"0","}"
"0",""
"0","lfc_shrink$entrez = unname(unlist(AnnotationDbi::mapIds(org.Mm.eg.db, keys=rownames(lfc_shrink), column=""ENTREZID"", keytype=""SYMBOL"", multiVals=""first"")))"
"2","'select()' returned 1:many mapping between keys and columns
"
"0","gsea_Results = GSEA_funk(lfc_shrink, org.Mm.eg.db)"
"2","using 'fgsea' for GSEA analysis, please cite Korotkevich et al (2019).

"
"2","preparing geneSet collections...
"
"2","GSEA analysis...
"
"2","Warning: There are ties in the preranked stats (0.03% of the list).
The order of those tied genes will be arbitrary, which may produce unexpected results."
"2","leading edge analysis...
"
"2","done...
"
"2","'select()' returned 1:1 mapping between keys and columns
"
"2","'select()' returned 1:1 mapping between keys and columns
"
"2","'select()' returned 1:1 mapping between keys and columns
"
